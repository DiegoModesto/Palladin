using System;
using System.Collections.Generic;
using System.ComponentModel.DataAnnotations;

namespace Palladin.Services.ViewModel.Vulnerability
{
    public class VulnerabilityViewModel
    {
        public Guid Id { get; set; }
        [Required(ErrorMessage = "Nome de vulnerabilidade é obrigatório")]
        [MinLength(3, ErrorMessage = "O nome precisa ter no mínimo 3 caracteres")]
        [MaxLength(80, ErrorMessage = "O nome pode ter no máximo 40 caracteres")]
        public string Name { get; set; }
        [MaxLength(500, ErrorMessage = "CVSS não pode ultrapassar 500 caracteres")]
        public string CVSS { get; set; }
        [Required(ErrorMessage = "Tipo de projeto é obrigatório")]
        public string ProjectType { get; set; }
        [Required(ErrorMessage = "Fator de risco é obrigatório")]
        public string RiskFactorType { get; set; }
        public Guid UserId { get; set; }
        public IEnumerable<string> Tags { get; set; }
        public IEnumerable<string> References { get; set; }
        
        public IEnumerable<VulnerabilityLangViewModel> Languages { get; set; }

        public VulnerabilityViewModel()
        {
            this.Languages = new List<VulnerabilityLangViewModel>();
            this.References = new List<string>();
            this.Tags = new List<string>();
        }
    }
}
